<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>主页</title>
    <link rel="stylesheet" href="../layui/css/layui.css" type="text/css">
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">

    <div class="layui-header layui-bg-gray">

        <div class="layui-logo" style="font-size: 20px; color: #393D49">作业查重系统学生端</div>

        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="/student/personal">
                    <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
                    <span style="color: black" th:text="${current.realname}"></span>
                </a>
            </li>
            <li class="layui-nav-item"><a id="logout" href="javascript:" style="color: black">注销</a></li>
        </ul>
    </div>

    <!-- 内容主体区域 -->
    <div class="layui-bg-green">
        <div style="padding: 15px; width: 80%; margin: auto">
            <div class="layui-row layui-col-space5 layui-bg-gray">
                <div class="layui-col-md12">
                    <div class="layui-row grid-demo">

                        <!-- 头部搜索框 -->
                        <div class="layui-col-md12" style="background: #00FF00; padding-top: 15px; padding-left: 20px">
                            <form class="layui-form" action="">
                                <div class="layui-inline" style="width: 10%">
                                    <div class="layui-input-inline">
                                        <select name="department" lay-verify="required">
                                            <option value="">选择系别</option>
                                            <option value="计算机系">计算机系</option>
                                            <option value="软件系">软件系</option>
                                            <option value="外语系">外语系</option>
                                            <option value="国贸系">国贸系</option>
                                            <option value="市场营销系">市场营销系</option>
                                            <option value="电子系">电子系</option>
                                            <option value="数码媒体系">数码媒体系</option>
                                            <option value="游戏系">游戏系</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="layui-inline" style="width: 88%">
                                    <div class="layui-input-inline" style="width: 93%">
                                        <input type="text" name="title" lay-verify="title" autocomplete="off"
                                               placeholder="输入教师姓名" class="layui-input">
                                    </div>
                                    <div class="layui-input-inline" style="width: 5%">
                                        <button type="submit" class="layui-btn layui-btn-warm" lay-submit=""
                                                lay-filter="demo1">搜索
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- 左边内容 -->
                        <div class="layui-col-md9">

                            <!-- 头部工具栏 -->
                            <form class="layui-form" action="" method="get">
                                <div class="layui-inline">
                                    <select id="typeSelect" name="type" lay-verify="" lay-filter="typeSelect">
                                        <option value="1" selected>必修</option>
                                        <option value="0">选修</option>
                                    </select>
                                </div>
                                <div class="layui-inline">
                                    <select id="departmentSelect" name="department" lay-verify="" lay-filter="departmentSelect">
                                        <option value="计算机系" selected>计算机系</option>
                                        <option value="软件系">软件系</option>
                                        <option value="外语系">外语系</option>
                                        <option value="国贸系">国贸系</option>
                                        <option value="市场营销系">市场营销系</option>
                                        <option value="电子系">电子系</option>
                                        <option value="数码媒体系">数码媒体系</option>
                                        <option value="游戏系">游戏系</option>
                                    </select>
                                </div>
                                <!--<div class="layui-inline">
                                    <select name="teacher" lay-verify="">
                                        <option value="realname" selected>教师姓名</option>
                                        <option value="username">教师工号</option>
                                    </select>
                                </div>
                                <div class="layui-input-inline" style="width: 30%">
                                    <input type="text" name="title" lay-verify="title" autocomplete="off"
                                           placeholder="输入教师姓名" class="layui-input">
                                </div>
                                <div class="layui-inline">
                                    <button lay-filter="searchBtn" type="button" lay-submit class="layui-btn layui-btn-primary">
                                        <i class="layui-icon layui-icon-search"></i>
                                    </button>
                                </div>-->
                            </form>

                            <!-- 数据表格 -->
                            <table class="layui-table" lay-filter="test" lay-data="{
                                       url:'/student/showInforms?type='+typeSelect+'&department='+departmentSelect
                                       ,limit:15
                                       ,height:'full-190'
                                       ,page: {
                                           layout: ['prev', 'page', 'next', 'skip','count']
                                           ,groups: 5
                                       }
                                       ,id:'demo'
                                       ,initSort:{field: 'date',type: 'desc'}}">
                                <thead>
                                    <tr>
                                        <th lay-data="{type: 'checkbox', fixed: 'left'}"></th>
                                        <th lay-data="{field: 'sendId', width:80, event: 'showUser', style:'cursor: pointer;'}">
                                            发布人
                                        </th>
                                        <th lay-data="{field: 'content', width :400, event: 'showInform', style:'cursor: pointer;'}">
                                            内容
                                        </th>
                                        <th lay-data="{field: 'type', width:60 , templet: '#typeTpl'}">类型</th>
                                        <th lay-data="{field: 'date'}">日期</th>
                                        <th lay-data="{field: 'path', event: 'showPath', style:'cursor: pointer;'}">通知路径
                                        </th>
                                    </tr>
                                </thead>
                            </table>

                        </div>

                        <!-- 右边内容 -->
                        <div class="layui-col-md3 layui-row grid-demo">
                            <div class="layui-col-md12" style="background: #8D8D8D">

                                <!-- 右上 -->
                                <table lay-filter="parse-table-demo">
                                    <thead>
                                    <tr>
                                        <th lay-data="{field:'username', width:200}">昵称</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>贤心1</td>
                                        <td>2016-11-28</td>
                                        <td>人生就像是一场修行 A</td>
                                    </tr>
                                    </tbody>
                                </table>

                                <!-- 右下 -->
                                <div class="layui-col-md12" style="background: #00FF00">
                                    <table lay-filter="parse-table-demo">
                                        <thead>
                                        <tr>
                                            <th lay-data="{field:'username', width:200}">昵称</th>
                                            <th lay-data="{field:'joinTime', width:150}">加入时间</th>
                                            <th lay-data="{field:'sign', minWidth: 180}">签名</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td>贤心1</td>
                                            <td>2016-11-28</td>
                                            <td>人生就像是一场修行 A</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- 模板 -->
<script type="text/html" id="typeTpl" th:inline="none">
    {{#  if(d.type === 1){ }}
    <label name="type" class="layui-form-label" style="text-align: left; padding-left: 0">必修</label>
    {{#  } else { }}
    <label name="type" class="layui-form-label" style="text-align: left; padding-left: 0">选修</label>
    {{#  } }}
</script>

<!-- 方法 -->
<script src="../webjars/jquery/3.4.1/jquery.js"></script>
<script src="../layui/layui.js" type="text/javascript"></script>
<script th:inline="none">

    let departmentSelect = $("#departmentSelect").val();
    let typeSelect = $("#typeSelect").val();

    $('#logout').click(function () {
        layer.confirm('确定退出系统吗',function () {
            window.location="/logout";
        })
    });

    layui.use(['form', 'table','element'], function () {
        var form = layui.form
            ,element = layui.element
            , table = layui.table;


        //监听下拉选择框
        form.on('select(typeSelect)', function (data) {
            var tmpParam = $("#departmentSelect").val();
            table.reload('demo',{
                url:'/student/showInforms?type='+data.value+'&department='+tmpParam
                ,page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
            console.log(data.value); //得到被选中的值
        });

        //监听下拉选择框
        form.on('select(departmentSelect)', function (data) {
            var tmpParam = $("#typeSelect").val();
            table.reload('demo',{
                url:'/student/showInforms?type='+tmpParam+'&department='+data.value
                ,page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
            layer.msg(data.value); //得到被选中的值
        });

        //监听单元格事件
        table.on('tool(test)', function (obj) {
            var data = obj.data;
            if (obj.event === 'showUser') {
                layer.msg("展示用户")
            } else if (obj.event === 'showInform') {
                layer.msg("展示通知内容")
            } else {
                layer.msg("展示文件路径")
            }
        });

    });


</script>
</body>
</html>
