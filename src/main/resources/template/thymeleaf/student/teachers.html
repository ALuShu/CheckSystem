<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>搜索结果</title>
    <link rel="stylesheet" href="../../layui/css/layui.css" type="text/css">
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header layui-bg-gray">

        <div class="layui-logo" style="font-size: 20px; color: #393D49; cursor: pointer" onclick="index()">作业查重系统学生端
        </div>

        <!-- 头部搜索框 -->
        <div style="margin:0 auto; width: 60%; padding-top: 10px">
            <form class="layui-form" action="">
                <div class="layui-inline" style="width: 15%">
                    <div class="layui-input-inline">
                        <select name="department" id="departmentSelect" lay-filter="departmentSelect">
                            <option value="">选择系别</option>
                            <option value="计算机系">计算机系</option>
                            <option value="软件系">软件系</option>
                            <option value="外语系">外语系</option>
                            <option value="国贸系">国贸系</option>
                            <option value="市场营销系">市场营销系</option>
                            <option value="电子系">电子系</option>
                            <option value="数码媒体系">数码媒体系</option>
                            <option value="游戏系">游戏系</option>
                        </select>
                    </div>
                </div>
                <div class="layui-inline" style="width: 80%">
                    <div class="layui-input-inline" style="width: 90%">
                        <input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="输入教师姓名"
                               class="layui-input">
                    </div>
                    <div class="layui-input-inline" style="width: 5%">
                        <button type="submit" class="layui-btn layui-btn-warm" lay-submit="" lay-filter="searchBtn">搜索
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="/student/personal">
                    <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
                    <span style="color: black" th:text="${current.realname}"></span>
                </a>
            </li>
            <li class="layui-nav-item"><a id="logout" href="javascript:" style="color: black">注销</a></li>
        </ul>
    </div>

    <!-- 结果表格 -->
    <table id="single" class="layui-table" th:if="${res} != null">
        <thead>
            <tr>
                <th>教师名称</th>
                <th>教师工号</th>
                <th>教师系别</th>
                <th>最近登录时间</th>
            </tr>
        </thead>
        <tbody>
            <tr style="cursor: pointer;" onclick="openSingle()">
                <td><span th:text="${res.getRealname()}"></span> </td>
                <td><span th:text="${res.getUsername()}"></span></td>
                <td><span th:text="${res.getDepartment()}"></span></td>
                <td><span th:text="${res.getLastLoginTime()}"></span></td>
            </tr>
        </tbody>
    </table>

    <!-- 数据表格 -->
    <table id="teachers" class="layui-table" th:if="${res} == null" lay-filter="teachers"></table>

</div>

<!-- 方法 -->
<script src="../../webjars/jquery/3.4.1/jquery.js"></script>
<script src="../../layui/layui.js" type="text/javascript"></script>
<script th:inline="none">

    $('#logout').click(function () {
        layer.confirm('确定退出系统吗', function () {
            window.location = "/logout";
        })
    });

    function index() {
        window.location = "/student/index"
    }

    function openSingle(){
        layer.msg("点击事件");
    }

    //layui官方方法
    layui.use('table', function () {
        var table = layui.table
            , element = layui.element;

        //layui数据表格
        table.render({
            elem: '#teachers'
            , url: '/student/showTeachers'
            ,limit:15
            ,height:'full-195'
            ,page: {
                layout: ['prev', 'page', 'next', 'skip','count']
                ,groups: 5
            }
            , cols: [[
                {field: 'realname', title: '教师名称', style: 'cursor: pointer;', event: 'openSingle'}
                , {field: 'username', title: '教师工号', sort: true}
                , {field: 'department', title: '教师系别',  sort: true}
                , {field: 'lastLoginTime', title: '最近登录时间'}
            ]]
        });


        //layui表格点击文件事件
        table.on('row(teachers)', function (obj) {
            layer.msg("点击事件")
        });

        //监听下拉选择框（未完成）
        form.on('select(departmentSelect)', function (data) {
            var tmpParam = $("#typeSelect").val();
            table.reload('demo', {
                url: '/student/showTeachers?department=' + data.value
                , page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
            layer.msg(data.value); //得到被选中的值
        });

    });
</script>
</body>
</html>